---
title: "Team_TAM_Case_Study01"
authors: 
- Andrew Heroy <aheroy@smu.edu>
- Martin Garcia <marting@smu.edu>
- Tej Tenmattam <ttenmattam@smu.edu>
date: "10/6/2018"
output: html_document
---

#TEJ YOU ARE GREAT AND THEN SOME and Andy too and Martin

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# MSDS 6306: Doing Data Science
### Case Study 01
#### 1. How many breweries are present in each state?
```{r}
# load the library dplyr https://dplyr.tidyverse.org/ 
library(dplyr)
# load ggplot2 library
library(ggplot2)
# load the data
beer <- read.csv("../data/Beers.csv", header = TRUE, sep = ",")
breweries <- read.csv("../data/Breweries.csv", header = TRUE, sep = ",")
# Rename "Name" column in brewaries to Brewery
breweries <- rename(breweries, Brewery = Name)
# Count breweries per state
BreweriesPerState <- count(breweries, State)
# Washington DC is not a state, so remove it.
BreweriesPerState <- BreweriesPerState[- grep("DC", BreweriesPerState$State), ]
# Change the column name "n" to "Breweries"
names(BreweriesPerState)[names(BreweriesPerState)=="n"] <- "Breweries"
# Sort the breweries in descending order
BreweriesPerState <- arrange(BreweriesPerState, desc(Breweries))
# Display the first 5 
head(BreweriesPerState,5)
# Plot the Breweris Per State
ggplot(BreweriesPerState, aes(x=reorder(State, Breweries), y=(Breweries))) + geom_bar(stat='identity') + coord_flip() + labs(title ="Breweries Per State", x = "State", y = "Number of Breweries")
```

#### 2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.
```{r}
# merge the two df's
# Change the Brewary_ID in the beer df to Brew_ID so we can merge the two df's by Brew_ID
beer <- rename(beer, Brew_ID = Brewery_id)
merged_data <- inner_join(beer, breweries, by = "Brew_ID")
# Display the first 6 observations 
head(merged_data,6)
# Display the last 6 observations
tail(merged_data,6)
```


#### 3. Report the number of NA's in each column.
```{r}
# Number of NA's in each column
sapply(merged_data, function(x) sum(is.na(x)))
# There are a total of 64 NA's in ABV column and 1005 in IBU column.
```

#### 4.Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.


```{r}

require(dplyr)
require(ggplot2)
require(reshape2)


merged_data %>% 
  group_by(merged_data$State) %>% 
  summarize(Median_ABV = median(ABV, na.rm = TRUE), Median_IBU = median(IBU, na.rm = TRUE)) -> MedianResults             
 
colnames(MedianResults) <- c("State", "Median_ABV", "Median_IBU")

# MedianResults <- melt(MedianResults, id.vars = c("Median_ABV", "Median_IBU"))
Plottyplotter <- ggplot(data=MedianResults, aes(x=MedianResults$State, y=MedianResults$Median_ABV, fill=State)) + geom_bar(stat="identity")  + theme_bw()

Plottyplotter1 <- ggplot(data=MedianResults, aes(x=MedianResults$State, y=MedianResults$Median_IBU, fill=State)) + geom_bar(stat="identity")  + theme_bw()


#write.csv(merged_data, file = "Merged.csv", row.names = F)

p <- Plottyplotter + labs(x = "State Abbr", y = "ABV", title = "Summary of ABV \n by State") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position = "none")
#slowly building our chart

p <- p + theme(axis.text.x = element_text(size = 6,
                                          angle =45,
                                          hjust = 1,
                                          vjust = 1))
                                               
      
b <- Plottyplotter1 + labs(x = "State Abbr", y = "IBU", title = "Summary of IBU \n by State") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.position = "none")
#slowly building our chart

b <- b  + theme(axis.text.x = element_text(size = 6,
                                          angle =45,
                                          hjust = 1,
                                          vjust = 1))


p
b



```
#### 5.Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?


```{r}

require(dplyr)
require(ggplot2)

# Takes the median results and stores the max for each state into a df 
merged_data %>% 
  group_by(merged_data$State) %>% 
  summarize(Max_ABV = max(ABV, na.rm = TRUE), Max_IBU = max(IBU, na.rm = TRUE)) -> MaxResults
colnames(MaxResults) <- c("State", "Max_ABV", "Max_IBU")

#Finds maximum of resultant dataset
MaxResults[which.max(MaxResults$Max_ABV),]
MaxResults[which.max(MaxResults$Max_IBU),]

#The state with the most alcoholic content is Colorado
#The state with the highest IBU is Oregon.
```

#### 6. Summary statistics for the ABV variable. Summary helps us find the min, mean, median, max.

```{r}
summary(merged_data[3])
sapply(merged_data[3], sd, na.rm=TRUE)
```


#### 7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.

```{r}
ggplot(merged_data, aes(x=ABV, y=IBU)) + geom_point() +geom_smooth(method=lm)

# Use Correlation function to determine our correlation of .67 which shows weak proof of correlation.
cor(merged_data$ABV, merged_data$IBU, use = "complete.obs")
